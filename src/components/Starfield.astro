---
interface Props {
	density?: 'low' | 'medium' | 'high';
	animated?: boolean;
	class?: string;
}

const { density = 'medium', animated = true, class: className = '' } = Astro.props;

const densityMap = {
	low: 50,
	medium: 100,
	high: 150,
};

const starCount = densityMap[density];
---

<div class:list={['starfield', { animated }, className]}>
	<div class="stars stars-layer-1"></div>
	<div class="stars stars-layer-2"></div>
	<div class="stars stars-layer-3"></div>
	<div class="shooting-stars">
		<div class="shooting-star"></div>
		<div class="shooting-star"></div>
		<div class="shooting-star"></div>
	</div>
</div>

<style>
	.starfield {
		position: absolute;
		inset: 0;
		overflow: hidden;
		pointer-events: none;
		z-index: 0;
	}

	.stars {
		position: absolute;
		inset: 0;
		background-repeat: repeat;
	}

	/* Layer 1 - Small distant stars */
	.stars-layer-1 {
		background-image:
			radial-gradient(circle at 20% 30%, rgba(255, 255, 255, 0.8) 1px, transparent 1px),
			radial-gradient(circle at 60% 70%, rgba(255, 255, 255, 0.6) 1px, transparent 1px),
			radial-gradient(circle at 80% 10%, rgba(255, 255, 255, 0.7) 1px, transparent 1px),
			radial-gradient(circle at 10% 80%, rgba(255, 255, 255, 0.5) 1px, transparent 1px),
			radial-gradient(circle at 40% 50%, rgba(255, 255, 255, 0.9) 1px, transparent 1px),
			radial-gradient(circle at 90% 90%, rgba(255, 255, 255, 0.4) 1px, transparent 1px);
		background-size: 200px 200px, 300px 300px, 250px 250px, 280px 280px, 220px 220px, 260px 260px;
		background-position: 0 0, 40px 60px, 130px 270px, 70px 100px, 150px 50px, 200px 180px;
		opacity: 0.6;
	}

	/* Layer 2 - Medium stars with color tint */
	.stars-layer-2 {
		background-image:
			radial-gradient(circle at 30% 40%, rgba(139, 92, 246, 0.4) 1.5px, transparent 1.5px),
			radial-gradient(circle at 70% 20%, rgba(236, 72, 153, 0.3) 1.5px, transparent 1.5px),
			radial-gradient(circle at 50% 80%, rgba(255, 255, 255, 0.5) 1.5px, transparent 1.5px),
			radial-gradient(circle at 15% 60%, rgba(139, 92, 246, 0.35) 1.5px, transparent 1.5px),
			radial-gradient(circle at 85% 45%, rgba(236, 72, 153, 0.4) 1.5px, transparent 1.5px);
		background-size: 300px 300px, 400px 400px, 350px 350px, 320px 320px, 380px 380px;
		background-position: 20px 30px, 100px 80px, 200px 150px, 50px 200px, 250px 100px;
		opacity: 0.5;
	}

	/* Layer 3 - Larger glowing stars */
	.stars-layer-3 {
		background-image:
			radial-gradient(circle at 25% 25%, rgba(255, 255, 255, 0.9) 2px, transparent 2px),
			radial-gradient(circle at 75% 75%, rgba(139, 92, 246, 0.6) 2px, transparent 2px),
			radial-gradient(circle at 50% 50%, rgba(236, 72, 153, 0.5) 2px, transparent 2px),
			radial-gradient(circle at 10% 90%, rgba(255, 255, 255, 0.7) 2px, transparent 2px);
		background-size: 400px 400px, 500px 500px, 450px 450px, 480px 480px;
		background-position: 0 0, 100px 100px, 250px 200px, 150px 50px;
		opacity: 0.4;
	}

	/* Twinkling animation */
	.animated .stars-layer-1 {
		animation: twinkle 8s ease-in-out infinite;
	}

	.animated .stars-layer-2 {
		animation: twinkle 12s ease-in-out infinite 2s;
	}

	.animated .stars-layer-3 {
		animation: twinkle 10s ease-in-out infinite 4s;
	}

	@keyframes twinkle {
		0%, 100% {
			opacity: 0.4;
		}
		50% {
			opacity: 0.8;
		}
	}

	/* Shooting stars */
	.shooting-stars {
		position: absolute;
		inset: 0;
	}

	.shooting-star {
		position: absolute;
		height: 2px;
		background: linear-gradient(90deg, rgba(255, 255, 255, 0) 0%, rgba(255, 255, 255, 0.8) 50%, rgba(255, 255, 255, 0) 100%);
		border-radius: 2px;
		opacity: 0;
		animation: shoot 8s linear infinite;
	}

	.shooting-star:nth-child(1) {
		top: 20%;
		left: 0;
		width: 100px;
		animation-delay: 0s;
	}

	.shooting-star:nth-child(2) {
		top: 50%;
		left: 0;
		width: 80px;
		animation-delay: 3s;
		background: linear-gradient(90deg, rgba(139, 92, 246, 0) 0%, rgba(139, 92, 246, 0.8) 50%, rgba(139, 92, 246, 0) 100%);
	}

	.shooting-star:nth-child(3) {
		top: 80%;
		left: 0;
		width: 120px;
		animation-delay: 6s;
		background: linear-gradient(90deg, rgba(236, 72, 153, 0) 0%, rgba(236, 72, 153, 0.8) 50%, rgba(236, 72, 153, 0) 100%);
	}

	@keyframes shoot {
		0% {
			transform: translateX(-100px) translateY(0) rotate(-45deg);
			opacity: 0;
		}
		5% {
			opacity: 1;
		}
		95% {
			opacity: 1;
		}
		100% {
			transform: translateX(120vw) translateY(60vh) rotate(-45deg);
			opacity: 0;
		}
	}

	.animated .shooting-star {
		animation-play-state: running;
	}

	/* Responsive adjustments */
	@media (max-width: 768px) {
		.stars-layer-1,
		.stars-layer-2,
		.stars-layer-3 {
			background-size: 150px 150px, 200px 200px, 180px 180px;
		}

		.shooting-star {
			display: none; /* Hide shooting stars on mobile for performance */
		}
	}

	@media (prefers-reduced-motion: reduce) {
		.stars-layer-1,
		.stars-layer-2,
		.stars-layer-3,
		.shooting-star {
			animation: none;
		}
	}
</style>
